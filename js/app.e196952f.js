(function(){var t={673:function(t,e,n){"use strict";var o=n(6848),a=n(9143),i=n.n(a),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.isLoggedIn?e("div",[e("div",{staticClass:"upload-container"},[e("div",{staticClass:"upload-wrapper"},[e("label",{staticClass:"upload-button"},[e("span",{staticClass:"upload-icon"},[t._v("📄")]),e("span",{staticClass:"upload-text"},[t._v("选择PDF文件")]),e("input",{attrs:{type:"file",accept:"application/pdf"},on:{change:t.handleFileUpload}})]),e("div",{staticClass:"action-buttons"},[e("button",{staticClass:"export-button",on:{click:t.exportToXLSX}},[e("span",{staticClass:"icon"},[t._v("📤")]),t._v(" 导出XLSX ")]),e("button",{staticClass:"batch-edit-button",on:{click:function(e){t.showBatchEditModal=!0}}},[e("span",{staticClass:"icon"},[t._v("✏️")]),t._v(" 批量编辑 ")])]),e("div",{staticClass:"conversion-system"},[e("h3",[t._v("PDF题在线转换系统（1.0.0）")]),e("div",{staticClass:"system-info"},[e("p",[t._v(" 文件："),e("span",{staticClass:"status"},[t._v(t._s(t.fileName))])])]),t._m(0)])])]),t.parsedData.length?e("div",{staticClass:"table-container"},[e("el-table",{staticStyle:{width:"100%"},attrs:{height:"650",data:t.parsedData,"table-layout":"fixed"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),e("el-table-column",{attrs:{prop:"course",label:"课程",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function({row:n}){return[e("el-input",{model:{value:n.course,callback:function(e){t.$set(n,"course",e)},expression:"row.course"}})]}}],null,!1,2592193046)}),e("el-table-column",{attrs:{prop:"unit",label:"单元",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function({row:n}){return[e("el-input",{model:{value:n.unit,callback:function(e){t.$set(n,"unit",e)},expression:"row.unit"}})]}}],null,!1,1529771917)}),e("el-table-column",{attrs:{prop:"type",label:"题目类型",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"content",label:"题目内容",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"answer",label:"正确答案",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"analysis",label:"解析",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"image",label:"配图",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"option1",label:"选项1",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option2",label:"选项2",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option3",label:"选项3",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option4",label:"选项4",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option5",label:"选项5",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option6",label:"选项6",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option7",label:"选项7",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option8",label:"选项8",align:"center",width:"100"}})],1)],1):t._e(),t.showBatchEditModal?e("div",{staticClass:"modal-overlay"},[e("div",{staticClass:"modal-content"},[e("h3",[t._v("批量编辑")]),e("div",{staticClass:"form-group"},[e("label",[t._v("课程：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.batchCourse,expression:"batchCourse"}],staticClass:"form-input",domProps:{value:t.batchCourse},on:{input:function(e){e.target.composing||(t.batchCourse=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",[t._v("单元：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.batchUnit,expression:"batchUnit"}],staticClass:"form-input",domProps:{value:t.batchUnit},on:{input:function(e){e.target.composing||(t.batchUnit=e.target.value)}}})]),e("div",{staticClass:"modal-actions"},[e("button",{staticClass:"confirm-button",on:{click:t.applyBatchEdit}},[t._v("确认")]),e("button",{staticClass:"cancel-button",on:{click:function(e){t.showBatchEditModal=!1}}},[t._v(" 取消 ")])])])]):t._e(),t.isUploading?e("div",{staticClass:"uploading-overlay"},[e("div",{staticClass:"uploading-spinner"}),e("div",{staticClass:"uploading-text"},[t._v("正在上传并解析PDF文件，请稍候...")])]):t._e()]):e("div",{staticClass:"login-container"},[e("div",{staticClass:"login-box"},[e("h2",[t._v("PDF题在线转换系统（1.0.0）")]),e("div",{staticClass:"form-group"},[e("label",[t._v("用户名：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-input",attrs:{type:"text"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",[t._v("密码：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-input",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("button",{staticClass:"login-button",on:{click:t.handleLogin}},[t._v("登录")])])])])},l=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"system-info"},[e("p",[t._v("当前状态："),e("span",{staticClass:"status"},[t._v("运行中")])])])}],r=(n(4114),n(8111),n(2489),n(116),n(7588),n(1701),n(5279)),c=n(6726),p=n.n(c),u=n(3230),d={name:"App",data(){return{parsedData:[],showBatchEditModal:!1,batchCourse:"",batchUnit:"",isUploading:!1,isLoggedIn:!0,username:"PDF题在线转换系统（1.0.0）",password:"123456",fileName:""}},mounted(){},methods:{async handleFileUpload(t){this.isUploading=!0;const e=t.target.files[0];this.fileName=e?e.name:"未选择文件";const n=this.fileName.match(/《(.+?)》/)?.[1]||"默认单元";setTimeout((async()=>{this.isUploading=!1;const e=t.target.files[0];if(e){const t=await e.arrayBuffer();r.GlobalWorkerOptions.workerSrc=p();try{const e=r.getDocument({data:t,disableAutoFetch:!0,disableStream:!0}),o=await e.promise,a=o.numPages;let i="";for(let t=1;t<=a;t++){const e=await o.getPage(t),n=await e.getTextContent();i+=n.items.map((t=>t.str)).join("\n")+"\n"}const s=i.replace(/羿过教育官网 www\.yiguojy\.com 版权所有/g,"").replace(/专业网校课程、题库软件、考试用书、资讯信息全方位一体化职业考试学习平台/g,""),l=s.split(/(?=\d+\.)/g),c=[];l.forEach((t=>{const e=t.split("\n").filter((t=>t.trim()));if(e.length>=3){const t=e.slice(1,-2).filter((t=>!t.startsWith("参考答案")&&!t.startsWith("【"))).map((t=>t.trim())),a=e.findIndex((t=>t.startsWith("【羿过解析】")));var o=e.slice(a).join("\n").split("【羿过解析】")[1];/\d$/.test(o)&&(o=o.slice(0,-1)),o&&o.endsWith("问答题")&&(o=o.slice(0,-3));const i={A:"option1",B:"option2",C:"option3",D:"option4",E:"option5",F:"option6",G:"option7",H:"option8"},s={};t.forEach((t=>{const e=t.match(/^([A-H])\.\s*(.*)/);if(e){const[,t,n]=e;s[i[t]]=n}}));const l=e.find((t=>t.startsWith("参考答案："))),r=-1!==e.findIndex((t=>t.startsWith("【羿过解析】")))?e.findIndex((t=>t.startsWith("【羿过解析】"))):e.length,p=e[e.indexOf(l)].replace("参考答案：","").trim().match(/^[A-H]$/)?.[0]||e.slice(e.indexOf(l),r).join("\n").replace(/\d+/g,"").replace("参考答案：","").trim();let u="";for(let n=0;n<e.length;n++){const t=e[n];if(t.startsWith("A.")){u=e.slice(0,n).join("").replace(/^\d+\./,"");break}if(t.endsWith("。")||t.endsWith("）")||t.includes("参考答案：")||t.endsWith("？")||/^\(\d+\)/.test(t)){if(t.includes("参考答案：")||(u+=t.replace(/^\d+\./,"")),t.endsWith("。")||t.endsWith("）")||t.includes("参考答案：")||t.endsWith("？"))break}else u+=t.replace(/^\d+\./,"")}console.log(p,"正确答案"),c.push({course:"专升本-法学类",unit:n,type:"单选题",content:u,answer:"A"==p?1:"B"==p?2:"C"==p?3:"D"==p?4:"E"==p?5:"F"==p?6:"G"==p?7:"H"==p?8:"对"==p?"T":"错"==p?"F":p,analysis:"【德鑫解析】"+(o||"此题暂无解析"),image:"",option1:s.option1,option2:s.option2,option3:s.option3,option4:s.option4,option5:s.option5,option6:s.option6,option7:s.option7,option8:s.option8})}})),this.parsedData=c}catch(o){console.error("PDF解析失败:",o)}}}),1500)},exportToXLSX(){if(0===this.parsedData.length)return void alert("没有数据可以导出！");const t={course:"课程",unit:"单元",type:"题目类型",content:"题目内容",answer:"正确答案",analysis:"解析",image:"配图",option1:"选项1",option2:"选项2",option3:"选项3",option4:"选项4",option5:"选项5",option6:"选项6",option7:"选项7",option8:"选项8"},e=this.parsedData.map((e=>{const n={};for(const o in e)n[t[o]]=e[o];return n})),n=u.Wp.json_to_sheet(e),o=u.Wp.book_new();u.Wp.book_append_sheet(o,n,"Sheet1");const a=this.fileName?this.fileName.replace(".pdf",".xlsx"):"export.xlsx";u._h(o,a)},applyBatchEdit(){this.parsedData.forEach((t=>{this.batchCourse&&(t.course=this.batchCourse),this.batchUnit&&(t.unit=this.batchUnit)})),this.showBatchEditModal=!1}}},f=d,h=n(1656),m=(0,h.A)(f,s,l,!1,null,null,null),b=m.exports;o["default"].use(i()),new o["default"]({el:"#app",render:t=>t(b)})},1815:function(){},3237:function(){},5168:function(){},6671:function(){},7492:function(){},7640:function(){}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var i=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,o,a,i){if(!o){var s=1/0;for(p=0;p<t.length;p++){o=t[p][0],a=t[p][1],i=t[p][2];for(var l=!0,r=0;r<o.length;r++)(!1&i||s>=i)&&Object.keys(n.O).every((function(t){return n.O[t](o[r])}))?o.splice(r--,1):(l=!1,i<s&&(s=i));if(l){t.splice(p--,1);var c=a();void 0!==c&&(e=c)}}return e}i=i||0;for(var p=t.length;p>0&&t[p-1][2]>i;p--)t[p]=t[p-1];t[p]=[o,a,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var a,i,s=o[0],l=o[1],r=o[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(r)var p=r(n)}for(e&&e(o);c<s.length;c++)i=s[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(p)},o=self["webpackChunkniuzi"]=self["webpackChunkniuzi"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(673)}));o=n.O(o)})();
//# sourceMappingURL=app.e196952f.js.map